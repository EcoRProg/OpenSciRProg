---
title: "Importar Datos Chla"
author: "L.A.S."
date: "July 17, 2018"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## Importa Chla

```{r importaChla}
source("R/functions.r")

chla <- read.delim("Data/Clorofila.txt", stringsAsFactors = FALSE)


require(lubridate)

fixedChla <- fixChlorophylData(chla)


require(ggplot2)

ggplot(fixedChla, aes(Date, IntegE1)) + geom_point(color="hotpink1") + scale_y_log10() + theme_minimal()

ggplot(fixedChla, aes(Date, IntegE2)) + geom_point(color="mediumpurple3") + scale_y_log10() + theme_minimal()

range(fixedChla$IntegE1, na.rm = TRUE)


require(tidyr)

ChlaRearrenged <- gather(fixedChla, IntegE1, IntegE2, key = "Station", value = "ChlaInteg")

ggplot(ChlaRearrenged, aes(Date, ChlaInteg, color=Station)) + geom_point() + geom_line() + scale_y_log10() + theme_minimal() + facet_wrap(~Station) + scale_color_brewer(palette = "Pastel1") + stat_smooth(se=FALSE)


require(dplyr)

ChlaRearrenged <- ChlaRearrenged %>% mutate(Month=month(Date)) #Modifica los valores de la variable Month haciendo que copie los meses de Date

ChlaByMonth <- ChlaRearrenged %>% group_by(Year, Month) %>% summarise(ChlaInteg=mean(ChlaInteg, na.rm = TRUE))

ggplot(ChlaByMonth, aes(factor(Month), ChlaInteg, color=Year)) + theme_minimal() + scale_y_log10() + geom_point()


```
